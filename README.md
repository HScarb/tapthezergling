# Tap the Zergling
## 1. 引言
### 1.1 编写目的

本文档是为了知道软件开发者，同时给本次的安卓游戏app开发起到一个大纲作用。
用过规范软件的开发过程达到提高软件质量，降低维护成本的目的。同时也可以降低本软件的开发难度，节省工作时间。

### 1.2 使用的文字处理和绘图工具

 - visual studio code
 - Markdown
 - Microsoft Office Visio

### 1.3 背景

 - 待开发app名称：Tap the Zergling
 - 项目开发单位：创新实践第四小组
 - 指导老师：邱洪君

### 1.3 参考资料
`[1]Cocos2d-x 3.x 游戏开发之旅 钟迪龙 电子工业出版社 版次：2014年10月`

## 2. 设计概述
### 2.1 任务和目标

开发一款面向儿童的休闲类游戏，促进儿童智力和反应能力的发展。获取更大的用户群体和用户粘性，实现盈利。

### 2.2 运行环境概述

Android 5.0.1 及更老的版本

## 3. 游戏规则
### 3.1 综述

本游戏由无限小关卡构成，玩家要做的是在给定的时间内尽快完成关卡，完成更多的关卡可以得到更高的分，玩家将以得到更高的分为目的。
本游戏会给与玩家一个总游戏时间，初始为10秒。玩家进行任何关卡时会消耗总时间。每通过一个小关卡都会奖励2秒总时间。
当总时间耗尽，游戏结束，记录得分。

小关卡的种类是有限的，但是在游戏中不断循环出现。不会出现连续两关都是同一种关卡的现象。
每10关构成一个循环，在第10关的时候出现Boss关。

### 3.2 机制

 1. 难度机制
    - 越后面的关卡难度越大，难度体现在关卡需要重复完成的次数和关卡内需要操作物品的数量。
 1. Boss关
    - 在每个整十数关出现Boss关，
 2. 宝石机制
    - 宝石为游戏中的通用货币。通过击败Boss开宝箱有三分之一的几率获得5-10个宝石。
    - 宝石可以购买额外的宝箱、购买能量、复活等等。
    - *宝石可以用真实货币在游戏中购买。
 3. 卡片机制
    - 卡片可以通过增加额外的奖励时间降低特定关卡的过关难度
    - 卡片有等级，等级越高的卡片奖励时间越多。
    - 两张相同的卡片可以合成一张高一级的同类卡片。
     - 等级1：奖励0.2s
     - 等级2：奖励0.4s
     - 等级3：奖励0.6s
     - ...以此类推
    - 一张卡片对应某一种关卡。
    - 玩家可以从击败Boss的奖励宝箱中获得一张随机的一级卡片奖励，获得卡片的概率为三分之一。
 4. 能量机制
    - 玩家需要花费1点能量才能进行一个关卡。
    - 能量每1小时自动增加1点。
    - 能量有一个上限值，当达到上限值时，能量不再随着时间增加。上限值为25。
    - 当能量耗尽，玩家将无法进行游戏，从而达到防沉迷的效果。
    - 玩家可以从击败Boss的奖励宝箱中获得5-10个能量奖励，获得能量的概率为三分之一。
    - 可以通过宝石购买能量。
 5. 等级机制
    - 玩家获得分数之后，获得等同于分数的经验值。
    - 当经验值达到升级所需要时，玩家的等级将提升。
    - 等级机制满足玩家的虚荣心，更多的用处有待增加。

## 4. 界面设计
### 4.1 开始场景
![main scene][mainscene]

包含了以下元素

 - 点击开始游戏
 - 能量框，显示能量数量
 - 宝石框，显示宝石数量，点击打开宝石购买层
 - 设置按钮
 - 卡片管理按钮
 - 最高得分

### 4.2 关卡选择场景
![tollgate scene][tollgatescene]

 - 能量框，显示能量数量
 - 宝石框，显示宝石数量，点击可进入宝石购买层
 - 主页按钮，点击返回开始场景
 - 卡片管理按钮，点击打开卡片管理层
 - 关卡动画示例
 - 关卡数显示
 
### 4.3 设置场景
 
 - 主页按钮，点击返回开始场景
 - 音乐控制
 - 音效控制
 - 重置购买
 - 关于
  
### 4.4 卡片管理层
![card enhancer][cardenhancer]

 1. 主界面
  - 依托于场景的一个层，同时层的下面有一个防触摸层。防止误触其他案件退出层。
  - 底部： 卡片存放处。
  - 画面中间: 卡片合成器界面。
 2. 卡片存放条
  - 关卡中所有收集到的卡片都存放在此。
  - 卡片有类型和等级之分。
  - 点击卡片可以出现卡片的介绍。
  - 通过ScrollView来存放卡片，
  - 可以拖动来查看所有卡片。
  - 单张卡片只能点击，不能拖动，
  - 卡片通过touch函数和getBoundBox来渐层是否触碰到卡片，
  - 卡片点击会出现一个新的层，这个层是用来显示卡片名称和卡片简介的。
  - 在同一类型并且等级相同的卡片出现两张或者以上时，
  - 卡片就可以进行拖动，拖到卡片合成器制定位置后点击collect就可以进行合成。在倒计时结束后就可以获得更高等级的卡片。新等级卡片效果更好。
 3. 卡片管理器
  - 一个单利类
  - 所有卡片的创建和删除都是通过这个来实现。
  - 使用cocos自带的Vector容器来存放所有创建的卡片。
  - 但是，每次获得的并不一定是有序的，
  - 每获得一张卡片就要和容器中现有卡片进行比较，然后再进行插入或者排到末尾。
  - 点击卡片来进行卡片介绍也是在这里实现。

### 4.5 宝石购买层
 
 - 关闭按钮
 - 各个价位的宝石图片
 - 购买按钮
 
### 4.6 关卡场景
 
 - 总时间条
 - 暂停按钮，点击暂停，并打开暂停层 

### 4.7 宝箱模块
 1. 宝箱的放置（即出现宝箱图片）。
 2. 鼠标点击静止的宝箱时，宝箱会有一段宝箱打开动画，过程大约持续1S。
 3. 宝箱开启过程中伴随有闪光的动画，闪光通过图片的旋转和放大动作实现。
 4. 当宝箱和闪光动画都进行完毕后，大约经过1S，宝箱渐渐消失，出现奖品。
 5. 奖品由三种组成，随机出现一种。三种分别为：卡片，能量，宝石。宝石和
能量的数量不会高于10，也不会低于5。卡片只会出现1级卡片。
 6. 出现奖品，点击奖品后，奖品会进去相应的模块中，点击宝石和卡片时，
会各有一段动画显示你的奖品已加入到你的模块中。（可以类比买食材，买的青菜
归入到蔬菜中，买的肉归入的荤菜中）
 7. 奖品领取完毕后，会重复到步骤（1），你仍旧可以打开宝箱重复上述过程，
但是你需要支付额外的宝石，最低需要10宝石，（也就是说不可能无限开宝箱）
宝石可以通过支付现实货币得到。
 8. 宝箱是特殊的，只能在每10关一次的BOSS关卡通关之后才会出现，
而且第一次打开宝箱是完全免费的。除此之外无法进入到宝箱界面。
 9. 卡片只能从宝箱中获得，能量还可以通过现实时间自然恢复，如每过2分钟
恢复1点，封顶30点。能量在每进行一关便会消耗一点，归0时不能进行游戏（
带有防沉迷效果）。但是也可以通过宝石购买能量。（所以有钱就行？？）卡片的作用
是根据等级增加关卡的额外剩余时间，特殊的卡片有特殊的功能，如安卓系统有一张
额外增加5点能量的永久卡片。

 
### 4.7 具体小关
#### 4.7.1 小狗成双
场景内部分为6*3的方格矩阵，每个方格为小狗图片大小。
关卡开始后，成双出现数只不同颜色的小狗。
难度系数越高，出现的小狗数量就越多。
玩家的目标是尽快将所有的小狗消除。
玩家需要同时点击两只颜色相同的小狗，方可消去这两只小狗。
当所有小狗都被消除，小关完成。

####4.7.2吃食物
场景部分为草原图片，小狗位于草原中央。
关卡开始后，在中央小狗周围随机的出现总共3~6个不等的食物（但场上最多只会存在3个，消除一个出现一个），
随着难度提升食物的数量会相应增加，手指触摸食物，食物会消失。
当第一次出现的食物全部消失时，会自动刷新出新一轮的食物，最多会出现3轮，随难度增加。
玩家的目标是尽快将所有的食物点灭。
当所有食物都被消除，小关完成。

#### 4.7.3 切农民
场景部分为草原图片，将划分为9*8个方格
关卡开始后，将会随机出现7个以上的农民图片，出现的地方限制为规定的72个方格内。
难度是由农民分布和同时出现的农民个数共同决定。
过关方式为滑动切除来清理农民，从触摸屏幕开始，从整个农民上划过，农民消失，直到所有农民消失，关卡结束。
目标：尽快消除所有农民，关卡计时会在触碰到屏幕的时候开始，全部消除完毕的时候结束。


## 5. 流程设计
![process diagram][img1]

------
[img1]: http://115.28.48.229/wordpress/wp-content/uploads/2016/08/particular_design.png
[mainscene]: http://115.28.48.229/wordpress/wp-content/uploads/2016/08/zergling_mainscene.png
[tollgatescene]: http://115.28.48.229/wordpress/wp-content/uploads/2016/08/zergling_tollgatescene.png
[cardenhancer]: http://115.28.48.229/wordpress/wp-content/uploads/2016/08/zergling_cardenhancer.png